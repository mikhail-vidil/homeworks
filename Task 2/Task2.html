<!DOCTYPE html>
<html>
    <head>
        <title>Task2</title>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="css/styles.css">
    </head>

    <body>
        <div class="container">
            <div class="content">
                <textarea id="textLines" placeholder="Введите, пожалуйста, текст пьесы..."></textarea> <br>
                <span class="menu-label">Выбор ролей:</span>
                <select id="choice" onchange="groupTextByRoles();">
                    <option value="Городничий" id="Городничий">Городничий</option>
                    <option value="Аммос Федорович" id="Аммос Федорович">Аммос Федорович</option>
                    <option value="Артемий Филиппович" id="Артемий Филиппович">Артемий Филиппович</option>
                    <option value="Лука Лукич" id="Лука Лукич">Лука Лукич</option>
                    <option value="Все реплики" id="Все роли">Все роли</option>
                </select>
                <br>
                <div class="text"></div>
            </div>
            
        </div>
        
        <script>
            //cols="60" rows="10"
            function groupTextByRoles() {
                var textLines = document.getElementById("textLines").value;
                var sel = document.getElementById('choice').selectedIndex;
                var text = textLines.split('\n');
                var roles = ["Городничий", "Аммос Федорович", "Артемий Филиппович", "Лука Лукич"];
                var output = [];
                var sortedRoles = [];
                roles.forEach(function(item, roles) {
                    output += '<b>' + item + ':' + '</b>' + '<br>';
                    for(var i = 0; i < text.length; i++) {
                        if(text[i].startsWith(item + '.')) {
                        output += i + 1 + ")" + text[i].slice(item.length + 1) + '<br>';
                        }
                    }
                    output += '<br>';
                });
                sortedRoles = output.toString().trim().split('<br><br>');
                switch (sel) {
                    case 0:
                    clear();
                    document.querySelector('.text').insertAdjacentHTML('beforeend', '<p>' + sortedRoles[sel].toString() + '</p>');
                    break;
                    
                    case 1:
                    clear();
                    document.querySelector('.text').insertAdjacentHTML('beforeend', '<p>' + sortedRoles[sel].toString() + '</p>');
                    break;

                    case 2:
                    clear();
                    document.querySelector('.text').insertAdjacentHTML('beforeend', '<p>' + sortedRoles[sel].toString() + '</p>');
                    break;

                    case 3:
                    clear();
                    document.querySelector('.text').insertAdjacentHTML('beforeend', '<p>' + sortedRoles[sel].toString() + '</p>');
                    break;

                    case 4:
                    clear();
                    document.querySelector('.text').insertAdjacentHTML('beforeend', '<p>' + output.toString().trim() + '</p>');
                    break;
                }
                
                function clear() {
                    if(document.querySelector('p')){
                        document.querySelector('p').remove();
                    }
                }
            }
        </script>
    </body>
</html>